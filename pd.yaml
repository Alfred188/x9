id: parameter-discovery

info:
  name: Headless Parameter Discovery
  author: Mohsen
  severity: info
  description: Takes parameters fuzz for the reflection
  tags: headless

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    # headers contain the headers for the request
    headers:
      # Custom user-agent header
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/112.0
      # Custom referrer header
      Referer: "{{RootURL}}"
      # Custom request origin
      Origin: "{{RootURL}}"
      # Custom cookie
      Cookie: pc_auth=zpx03hxz8avb0o9l0765i2aqmwmux9pf3aod8duh73zu3846f92dsiyehymtv0ip

    matchers-condition: or
    matchers:
      - type: word
        words:
          - <b>minj
        part: body
      - type: word
        words:
          - <b/minj
        part: body
      - type: word
        words:
          - '"minj""'
        part: body
      - type: word
        words:
          - "'minj''"
        part: body
    actions:
      - name: Make Curl Request
        type: webhook
        hook-config:
          method: POST
          url: "https://discord.com/api/webhooks/1137363398544347206/_6s7mlGykssqUf5oToiKY1eAav8WpV1KQNTyvrxpB36JGTTnVd6kfAJo-xzI24veDI_C"
          headers:
            - "Content-Type: application/json"
          body: {"username": "Nuclei_Reflection_Finder","content": "{{BaseURL}}"}